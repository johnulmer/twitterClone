<!DOCTYPE html>
<html>
<head>
</head>
<body>
	<h1>Today I shall assume a new identity <i>TwitterClone&trade;!</i></h1>
	<table><tr><td>
		<div id="divUserName"><label id="lblUserName">User Name: </label>{{user.getUserName()}}</div><br/>
		<label id="lblPassword">Password: </label><input type="text" id="txtPassword" value="{{user.getPassword()}}"></input><br/>
		<label id="lblHandle">Handle: </label><input type="text" id="txtHandle" value="{{user.getHandle()}}"></input></td>
		<td><button id="btnUpdate">Update</button> handle or password.</td>
			</tr>
			<tr><td colspan="2"><div id="responseMsg"></div></td>
		</table>
		<script>

		// attach code to UI elements
		btnUpdate = document.getElementById("btnUpdate");
		divUserName = document.getElementById("divUserName");
		txtPassword = document.getElementById("txtPassword");
		txtHandle = document.getElementById("txtHandle");
		divResponseMsg = document.getElementById("responseMsg");
		divResponseMsg.innerHTML = "did i get a session? " + '@Session["handle"]';

//get login form data, send to authenticate method
		btnUpdate.addEventListener('click', function (evt) {
			var xhr = new XMLHttpRequest();
			xhr.open('POST', '/update');
			xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
			xhr.onload = function() {
					if (xhr.status === 200) {
							var authResponse = xhr.responseText;
							if (authResponse == "SUCCESS") {
								window.location = "https://www.google.com/";
							} else {
							divResponseMsg.innerHTML = authResponse;
						}
					} else if (xhr.status !== 200) {
							alert('Request failed.  Returned status of ' + xhr.status);
					}
			};
			var handle = txtHandle.value;
			var password = txtPassword.value;
			var body = 'handle=' + encodeURIComponent(handle) + '&password=' + encodeURIComponent(password);
			console.log(body);
			xhr.send(body);
		});

		</script>
		</body>
		</html>
